plugins {
    id'java'
    id'application'
    id'com.github.johnrengelman.shadow' version '2.0.1'
}

mainClassName = 'me.richdev.TheWatcher.Main'
version '1.0-BETA'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
    jcenter()
    flatDir {
        dirs 'libs'
    }
}


dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.12'
    compile "net.dv8tion:JDA:3.4.0_324"
    compile 'com.sedmelluq:lavaplayer:1.2.45'
    compile 'com.google.code.gson:gson:2.8.2'
    compile group: 'mysql', name: 'mysql-connector-java', version: '5.1.6'
    compile group: 'org.apache.commons', name: 'commons-lang3', version: '3.5'
}

sourceSets {
    main {
        java {
            srcDirs 'src/main'
        }
    }
}

jar {
    manifest {
        attributes(
                "Class-Path": configurations.compile.collect { "lib/" + it.getName() }.join(' '), "Main-Class": "me.richdev.TheWatcher.Main")
    }
}

task copyDependenciesToLib(type: Copy) {
    dependsOn build
    from configurations.runtime
    from jar
    into "${project.buildDir}/libs/lib/"
}

run {
    args = ["testmode"]
}

compileJava.options.encoding = 'UTF-8'
